#!/bin/bash

# Store the files that have been changed
STAGED_FILES=$(git diff --cached --name-only --diff-filter=d | grep -e '\.swift$')

if [[ "$STAGED_FILES" = "" ]]; then
  exit 0
fi

echo "üîç Running pre-commit hook for Swift files..."

# Run SwiftFormat
echo "‚ú® Running SwiftFormat..."
swiftformat $STAGED_FILES

# Run SwiftLint
echo "üßπ Running SwiftLint..."
swiftlint --fix $STAGED_FILES

# Add back the formatted files to staging
git add $STAGED_FILES

echo "‚úÖ Pre-commit formatting complete!"

exit 0
